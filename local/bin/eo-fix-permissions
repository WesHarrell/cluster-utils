#!/bin/bash
# script fix shared space permissions
PROJHOME=/nfs/sloanlab001/projects

#make sure projects space and links exist, if not, create
grplist=`groups | grep _proj`
for gr in `echo $grplist`; do
  if [[ $gr =~ .*_proj && -d $PROJHOME/$gr ]]; then
    find $PROJHOME/$gr -user $USER -exec chgrp $gr {} \;
    find $PROJHOME/$gr -user $USER -type f -exec chmod ug+rw {} \;
    find $PROJHOME/$gr -user $USER -type d -exec chmod ug+rws {} \;
  fi
done
#fix pool
chmod -f 700 /pool001/$USER
#fix lustre
chmod -f 700 /nobackup1/$USER

echo""
echo "File and folder permissions fixed on files owned by you.  To"
echo "ensure all files in your shared project space are correct please"
echo "ask your project colleagues to run the eo-fix-permissions command"

echo""

exit 0

